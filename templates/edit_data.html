<!DOCTYPE html>
<html lang="ja">
<head>
  {% include "header.html" %}
  <meta charset="UTF-8">
  <title>データ編集</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
  <h1>財務データ編集</h1>

  <div class="actions-row">
    <a class="btn" href="{{ url_for('view_data') }}">一覧へ</a>
    <a class="btn" href="{{ url_for('graph_view') }}">グラフへ</a>
  </div>

  <form method="POST" class="card">

    <div class="section-box">
      <h3>基本情報</h3>

      <div class="form-row">
        <label>企業名</label>
        <input name="company_name" value="{{ data[1] }}" required>
      </div>

      <div class="form-row">
        <label>業種</label>
        <input name="industry" value="{{ data[2] }}" required>
      </div>

      <div class="form-row">
        <label>年度</label>
        <input name="year" value="{{ data[3] }}" required>
      </div>
    </div>

    <div class="section-box">
      <h3>財務数値</h3>

      <div class="form-row"><label>売上高</label><input name="sales" value="{{ data[4] }}" required></div>
      <div class="form-row"><label>売上総利益</label><input name="gross_profit" value="{{ data[5] }}" required></div>
      <div class="form-row"><label>当期純利益</label><input name="net_income" value="{{ data[6] }}" required></div>
      <div class="form-row"><label>総資産</label><input name="total_assets" value="{{ data[7] }}" required></div>
      <div class="form-row"><label>自己資本</label><input name="equity" value="{{ data[8] }}" required></div>
      <div class="form-row"><label>流動資産</label><input name="current_assets" value="{{ data[9] }}" required></div>
      <div class="form-row"><label>流動負債</label><input name="current_liabilities" value="{{ data[10] }}" required></div>
      <div class="form-row"><label>総負債</label><input name="liabilities" value="{{ data[11] }}" required></div>
      <div class="form-row"><label>従業員数</label><input name="employees" value="{{ data[12] }}" required></div>

      <div class="actions-row">
        <button type="submit" class="btn">更新</button>
        <a class="btn" href="{{ url_for('view_data') }}">一覧で確認</a>
      </div>
    </div>

  </form>

  <div class="section-box">
    <h2>コメント</h2>

    <form method="POST" action="{{ url_for('add_comment', id=data[0]) }}">
      <div class="form-row">
        <label>新規コメント</label>
        <textarea name="content" placeholder="コメントを入力" required></textarea>
      </div>
      <div class="actions-row">
        <button class="btn" type="submit">追加</button>
      </div>
    </form>

    {% if comments %}
      {% for c in comments %}
        <div class="box-soft" style="margin-top:10px;">
          <form method="POST" action="{{ url_for('edit_comment', id=c[0]) }}">
            <div class="form-row">
              <label>編集</label>
              <textarea name="content">{{ c[3] }}</textarea>
            </div>
            <div class="actions-row">
              <button class="btn" type="submit">保存</button>
            </div>
          </form>

          <form method="POST" action="{{ url_for('delete_comment', id=c[0]) }}">
            <div class="actions-row">
              <button class="btn" type="submit">削除</button>
            </div>
          </form>
        </div>
      {% endfor %}
    {% else %}
      <p class="muted">コメントはまだありません。</p>
    {% endif %}
  </div>

</div>

</body>
</html>
